<?xml version="1.0" encoding="UTF-8"?>
<ui:composition template="/WEB-INF/controlPanel.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:jsf="http://xmlns.jcp.org/jsf"
                xmlns:a="http://xmlns.jcp.org/jsf/passthrough">
    <ui:define name="content">
        <div id="layoutSidenav_content">
            <main>
                <div class="container-fluid px-4">
                    <h:messages id="msg" globalOnly="true" layout="table" showDetail="true" />
                    <div class="table-responsive overflow-table mt-3">
                        <h:dataTable id="tabRuta" value="#{rutaController.rutaList}" var="ruta"
                                     styleClass="table text-center table-hover" headerClass="bg-white">
                            <f:facet name="header">
                                <div class="d-flex justify-content-between">
                                    <label>&#160;</label>
                                    <h:outputText styleClass="fs-4 text-uppercase"
                                                  value="#{lenguaje['blt.ruta.nombre']}" />
                                    <!-- Botones -->
                                    <div class="btn-group" role="group" aria-label="Basic outlined example">
                                        <!-- Btn Agregar -->
                                        <button class="btn btn-outline-primary tooltip-container" type="button"
                                                data-bs-toggle="modal" data-bs-target="#modalTabla"
                                                jsf:actionListener="#{rutaController.agregarRuta()}">
                                            <span class="tooltiptext-left">#{lenguaje['g.agregar']}</span>
                                            <i class="bi bi-plus-lg"/>
                                            <f:ajax render="form:panelModalForm form:msgInput" />
                                        </button>
                                        <!-- Btn Recargar -->
                                        <button class="btn btn-outline-success tooltip-container" type="button"
                                                jsf:actionListener="#{rutaController.recargarTabla()}">
                                            <span class="tooltiptext-left">#{lenguaje['g.actualizar-tabla']}</span>
                                            <i class="bi bi-arrow-repeat" />
                                            <f:ajax render="form:tabRuta form:panel-toast"
                                                    event="click" onevent="deshabilitarRecarga(this)" />
                                        </button>
                                    </div>
                                </div>
                            </f:facet>
                            <!-- Column -->
                            <h:column headerClass="col-header">
                                <f:facet name="header">
                                    <h:outputText value="#" />
                                </f:facet>
                                <h:outputText value="#{ruta.idRuta}" />
                            </h:column>
                            <!-- Column -->
                            <h:column headerClass="col-header">
                                <f:facet name="header">
                                    <h:outputText value="#{lenguaje['blt.ruta.ciudad-ini']}" />
                                </f:facet>
                                <h:outputText value="#{ruta.codCiudadIni.nombreCiudad}" />
                            </h:column>
                            <!-- Column -->
                            <h:column headerClass="col-header">
                                <f:facet name="header">
                                    <h:outputText value="#{lenguaje['blt.ruta.ciudad-fin']}" />
                                </f:facet>
                                <h:outputText value="#{ruta.codCiudadFin.nombreCiudad}" />
                            </h:column>
                            <!-- Column -->
                            <h:column headerClass="col-header">
                                <f:facet name="header">
                                    <h:outputText value="#{lenguaje['imba.operadora.nombre']}" />
                                </f:facet>
                                <h:outputText value="#{ruta.idOperadora.nombreOperadora}" />
                            </h:column>
                            <!-- Column -->
                            <h:column headerClass="col-header">
                                <f:facet name="header">
                                    <h:outputText value="#{lenguaje['g.precio']}" />
                                </f:facet>
                                <h:outputText value="#{ruta.precioRuta}" />
                            </h:column>
                            <!-- Accion -->
                            <h:column headerClass="col-header">
                                <f:facet name="header">
                                    <h:outputText value="" />
                                </f:facet>
                                <div class="btn-group" role="group" aria-label="Basic outlined example">
                                    <!-- Btn Editar -->
                                    <button class="btn btn-outline-primary tooltip-container" type="button"
                                            data-bs-toggle="modal" data-bs-target="#modalTabla"
                                            jsf:actionListener="#{rutaController.verRuta(ruta)}">
                                        <span class="tooltiptext-top">#{lenguaje['g.editar']}</span>
                                        <i class="bi bi-pen-fill" />
                                        <f:ajax render="form:panelModalForm" />
                                    </button>
                                </div>
                            </h:column>
                        </h:dataTable>
                    </div>
                    <!-- Modal Agregar/Editar-->
                    <div class="modal fade" id="modalTabla" tabindex="-1"
                         aria-labelledby="modalTabla" aria-hidden="true">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title text-uppercase">#{lenguaje['blt.ruta.nombre']}</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" />
                                </div>
                                <div class="modal-body">
                                    <!-- Msg -->
                                    <div id="alert-container" class="alert alert-danger alert-dismissible fade show"
                                         role="alert" style="display: none">
                                        <h:messages id="msgInput" layout="table"
                                                    errorClass="bi bi-exclamation-diamond-fill tr-before"
                                                    warnClass="bi bi-exclamation-triangle-fill tr-before"/>
                                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close" />
                                    </div>
                                    <!-- Form -->
                                    <h:panelGroup id="panelModalForm" styleClass="container-fluid">
                                        <!-- Input -->
                                        <div class="row mb-3">
                                            <div class="input-group form-floating">
                                                    <span class="input-group-text text-light bg-primary">
                                                        <i class="bi bi-card-heading" />
                                                    </span>
                                                <h:inputText id="txtFocus" type="text" onblur="validarCampo(this)"
                                                             styleClass="form-control validate"
                                                             value="#{rutaController.ruta.nombreRuta}"
                                                             required="true" requiredMessage="#{lenguaje['blt.ruta.required.precio']}"
                                                             a:placeholder="txtCodRuta" />
                                                <label for="txtFocus" class="label-floating">
                                                    #{lenguaje['blt.ruta.nombre']}&#160;<b class="text-primary">*</b>
                                                </label>
                                            </div>
                                        </div>
                                        <!-- Input -->
                                        <div class="row mb-3">
                                            <div class="input-group form-floating">
                                                    <span class="input-group-text text-light bg-primary">
                                                        <i class="bi bi-bank" />
                                                    </span>
                                                <input type="text" id="inputList1" list="autocomplete-inputList1"
                                                       class="form-control validate" placeholder="select"
                                                       required="true" jsf:requiredMessage="#{lenguaje['blt.ruta.required.ciudad-ini']}"
                                                       value="#{rutaController.ciudadIni.nombreCiudad}"
                                                       onblur="buscarValorDataList(this); validarCampo(this)" />
                                                <datalist id="autocomplete-inputList1">
                                                    <ui:repeat value="#{rutaController.ciudadList}" var="ciudad"
                                                               varStatus="estado">
                                                        <option data-value="#{ciudad.codCiudad}">#{ciudad.nombreCiudad}</option>
                                                    </ui:repeat>
                                                </datalist>
                                                <label for="autocomplete-inputList1" class="label-floating">
                                                    #{lenguaje['blt.ruta.ciudad-ini']}&#160;<b class="text-primary">*</b>
                                                </label>
                                                <h:inputText id="hidden-inputList1" a:type="hidden"
                                                             value="#{rutaController.ciudadIni.codCiudad}" />
                                            </div>
                                        </div>
                                        <!-- Input -->
                                        <div class="row mb-3">
                                            <div class="input-group form-floating">
                                                    <span class="input-group-text text-light bg-primary">
                                                        <i class="bi bi-bank" />
                                                    </span>
                                                <input type="text" id="inputList2" list="autocomplete-inputList2"
                                                       class="form-control validate" placeholder="select"
                                                       required="true" jsf:requiredMessage="#{lenguaje['blt.ruta.required.ciudad-fin']}"
                                                       value="#{rutaController.ciudadFin.nombreCiudad}"
                                                       onblur="buscarValorDataList(this); validarCampo(this)" />
                                                <datalist id="autocomplete-inputList2">
                                                    <ui:repeat value="#{rutaController.ciudadList}" var="ciudad"
                                                               varStatus="estado">
                                                        <option data-value="#{ciudad.codCiudad}">#{ciudad.nombreCiudad}</option>
                                                    </ui:repeat>
                                                </datalist>
                                                <label for="autocomplete-inputList2" class="label-floating">
                                                    #{lenguaje['blt.ruta.ciudad-fin']}&#160;<b class="text-primary">*</b>
                                                </label>
                                                <h:inputText id="hidden-inputList2" a:type="hidden"
                                                             value="#{rutaController.ciudadFin.codCiudad}" />
                                            </div>
                                        </div>
                                        <!-- Input -->
                                        <div class="row">
                                            <div class="input-group form-floating">
                                                    <span class="input-group-text text-light bg-primary">
                                                        <i class="bi bi-card-checklist" />
                                                    </span>
                                                <input type="text" id="inputList3" list="autocomplete-inputList3"
                                                       class="form-control validate" placeholder="select"
                                                       required="true" jsf:requiredMessage="#{lenguaje['blt.ruta.required.operadora']}"
                                                       value="#{rutaController.operadora.nombreOperadora}"
                                                       onblur="buscarValorDataList(this); validarCampo(this)" />
                                                <datalist id="autocomplete-inputList3">
                                                    <ui:repeat value="#{rutaController.operadoraList}" var="operadora"
                                                               varStatus="estado">
                                                        <option data-value="#{operadora.idOperadora}">#{operadora.nombreOperadora}</option>
                                                    </ui:repeat>
                                                </datalist>
                                                <label for="autocomplete-inputList3" class="label-floating">
                                                    #{lenguaje['imba.operadora.nombre']}&#160;<b class="text-primary">*</b>
                                                </label>
                                                <h:inputText id="hidden-inputList3" a:type="hidden"
                                                             value="#{rutaController.operadora.idOperadora}" />
                                            </div>
                                        </div>
                                        <!-- Input -->
                                        <div class="row mb-3">
                                            <div class="input-group form-floating">
                                                <span class="input-group-text text-light bg-primary">
                                                    <i class="bi bi-card-heading" />
                                                </span>
                                                <h:inputText id="txtPrecio" type="text" onblur="validarCampo(this)"
                                                             styleClass="form-control validate"
                                                             value="#{rutaController.ruta.precioRuta}"
                                                             required="true" requiredMessage="#{lenguaje['blt.ruta.required.precio']}"
                                                             a:placeholder="input" />
                                                <label for="txtPrecio" class="label-floating">
                                                    #{lenguaje['g.precio']}&#160;<b class="text-primary">*</b>
                                                </label>
                                            </div>
                                        </div>
                                        <!-- Input -->
                                        <div class="row mb-3">
                                            <div class="input-group form-floating">
                                                <span class="input-group-text text-light bg-primary">
                                                    <i class="bi bi-card-heading" />
                                                </span>
                                                <h:inputText id="txtLatIni" type="text" onblur="validarCampo(this)"
                                                             styleClass="form-control validate"
                                                             value="#{rutaController.ruta.latiniRuta}"
                                                             required="true" requiredMessage="#{lenguaje['blt.ruta.required.coordenadas-ini']}"
                                                             a:placeholder="input" />
                                                <label for="txtLatIni" class="label-floating">
                                                    #{lenguaje['blt.ruta.latitud-ini']}&#160;<b class="text-primary">*</b>
                                                </label>
                                                <h:inputText id="txtLngIni" type="text" onblur="validarCampo(this)"
                                                             styleClass="form-control validate"
                                                             value="#{rutaController.ruta.lnginiRuta}"
                                                             required="true" requiredMessage="#{lenguaje['blt.ruta.required.coordenadas-ini']}"
                                                             a:placeholder="input" />
                                                <label for="txtLngIni" class="label-floating">
                                                    #{lenguaje['blt.ruta.longitud-ini']}&#160;<b class="text-primary">*</b>
                                                </label>
                                            </div>
                                        </div>
                                        <!-- Input -->
                                        <div class="row mb-3">
                                            <div class="input-group form-floating">
                                                <span class="input-group-text text-light bg-primary">
                                                    <i class="bi bi-card-heading" />
                                                </span>
                                                <h:inputText id="txtLatFin" type="text" onblur="validarCampo(this)"
                                                             styleClass="form-control validate"
                                                             value="#{rutaController.ruta.latfinRuta}"
                                                             required="true" requiredMessage="#{lenguaje['blt.ruta.required.coordenadas-fin']}"
                                                             a:placeholder="input" />
                                                <label for="txtLatFin" class="label-floating">
                                                    #{lenguaje['blt.ruta.latitud-fin']}&#160;<b class="text-primary">*</b>
                                                </label>
                                                <h:inputText id="txtLngFin" type="text" onblur="validarCampo(this)"
                                                             styleClass="form-control validate"
                                                             value="#{rutaController.ruta.lngfinRuta}"
                                                             required="true" requiredMessage="#{lenguaje['blt.ruta.required.coordenadas-fin']}"
                                                             a:placeholder="input" />
                                                <label for="txtLngFin" class="label-floating">
                                                    #{lenguaje['blt.ruta.longitud-fin']}&#160;<b class="text-primary">*</b>
                                                </label>
                                            </div>
                                        </div>
                                    </h:panelGroup>
                                </div>
                                <div class="modal-footer">
                                    <!-- Cancelar -->
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                                        <i class="bi bi-x me-2" />#{lenguaje['g.cancelar']}
                                    </button>
                                    <!-- Guardar -->
                                    <button class="btn btn-outline-primary" type="button"
                                            jsf:actionListener="#{rutaController.guardarActualizarRuta()}">
                                        <i class="bi bi-sd-card-fill" />#{lenguaje['g.guardar']}
                                        <f:ajax execute="@form" render="form:tabRuta form:msgInput form:panel-toast"
                                                onevent="validarModal()" />
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Modal Pregunta-->
                    <div class="modal fade" id="modalEliminar" tabindex="-1"
                         aria-labelledby="modalEliminar" aria-hidden="true">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title">#{lenguaje['blt.ruta.nombre']}</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" />
                                </div>
                                <div class="modal-body">
                                    <label>#{lenguaje['g.msg.eliminar']}</label>
                                </div>
                                <div class="modal-footer">
                                    <!-- Cancelar -->
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                                        <i class="bi bi-x me-2" />#{lenguaje['g.cancelar']}
                                    </button>
                                    <!-- Confirmar -->
                                    <button class="btn btn-outline-primary" type="button" data-bs-dismiss="modal"
                                            jsf:actionListener="#{rutaController.eliminarRuta()}">
                                        <i class="bi bi-trash me-2" />#{lenguaje['g.eliminar']}
                                        <f:ajax render="form:tabRuta form:panel-toast" onevent="toast.show()" />
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
            <ui:include src="/WEB-INF/controlPanelFooter.xhtml" />
        </div>
    </ui:define>
</ui:composition>